# ä»"ç‰ˆæœ¬å·æ‰“æ¶"åˆ° 30 ç§’å†…æé†’ç”¨æˆ·åˆ·æ–°ï¼šä¸€ä¸ªå¾®å‰ç«¯å›¢é˜Ÿçš„å®è·µ

## 1. èƒŒæ™¯ä¸ç—›ç‚¹

æˆ‘ä»¬å›¢é˜Ÿç»´æŠ¤ç€ä¸€ä¸ªå¾®å‰ç«¯å­åº”ç”¨é›†ç¾¤ï¼Œæ¯ä¸ªå­åº”ç”¨éƒ½éœ€è¦åŒæ—¶æœåŠ¡ dev / test / release / online å¤šå¥—ç¯å¢ƒã€‚åˆ†æ”¯ç­–ç•¥ï¼ˆmaster / release / test / dev / hotfix / feature\_x.x.xï¼‰åŠ ä¸Š Jenkins è‡ªåŠ¨åŒ–ï¼Œè®©"ä¸€å¤©å¤šæ¬¡å‘å¸ƒ"æˆä¸ºå¸¸æ€ã€‚ä½†çœŸæ­£å½±å“äº¤ä»˜æ•ˆç‡çš„å¹¶ä¸æ˜¯å‘å¸ƒæ¬¡æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªé¡½å›ºçš„é—®é¢˜ï¼š**æµ‹è¯•åŒå­¦å¸¸å¹´åœç•™åœ¨æ—§ç‰ˆæœ¬é¡µé¢**ã€‚

### 1.1 çœŸå®åœºæ™¯

*   æµ‹è¯•åœ¨æ—©ä¸Šæ‰“å¼€ dev é¡µé¢ï¼Œä¸‹åˆæˆ‘ä»¬å‘å¸ƒäº†æ–°çš„ç»„ä»¶æ ·å¼ï¼›
*   ä»–ä»¬ç»§ç»­åœ¨æ—§é¡µé¢é‡Œå›å½’ï¼Œåé¦ˆçš„é—®é¢˜æˆ‘ä»¬ä¸€çœ¼çœ‹å‡º"è¿™æ˜¯è€ç‰ˆæœ¬"ï¼›
*   ç¾¤é‡Œå–Š"åˆ·æ–°ä¸€ä¸‹"å¹¶ä¸é è°±ï¼Œäºæ˜¯"æ— æ•ˆç¼ºé™· + åå¤æ²Ÿé€š"æˆäº†å¸¸æ€ã€‚

æ›´ä¸¥é‡çš„ä¸€æ¬¡äº‹æ•…ï¼Œæ˜¯æˆ‘ä»¬åœ¨ç‰ˆæœ¬æ£€æŸ¥é€»è¾‘é‡ŒåŒæ—¶ä½¿ç”¨äº† webpack DefinePlugin ä¸è‡ªå®šä¹‰æ’ä»¶ï¼Œå„è‡ªè°ƒç”¨äº†ä¸€æ¬¡ `getAppVersion()`ã€‚ç»“æœå‰ç«¯æ§åˆ¶å°æ‰“å°çš„æ˜¯ `0.8.3-release-202511210828`ï¼Œè€Œ `version.json` é‡Œæ˜¯ `0.8.3-release-202511210829`ã€‚ä¸¤è¾¹åªå·® 1 ç§’é’Ÿï¼Œå´è®©çº¿ä¸Šç”¨æˆ·å§‹ç»ˆè¢«æç¤ºåˆ·æ–°ï¼Œå½¢è±¡åœ°è¢«å›¢é˜Ÿç§°ä¸º"ç‰ˆæœ¬å·æ‰“æ¶"ã€‚

### 1.2 æˆ‘ä»¬çš„è¯‰æ±‚

1.  ç”¨æˆ·åœ¨ 30 ç§’å†…æ„ŸçŸ¥ç‰ˆæœ¬æ›´æ–°ï¼›
2.  å¼¹çª—é‡Œèƒ½çœ‹åˆ°"å½“å‰ç‰ˆæœ¬ / æœ€æ–°ç‰ˆæœ¬ / ç¯å¢ƒ"ï¼›
3.  æ”¯æŒ"ç«‹å³åˆ·æ–° / ç¨åå†è¯´"ï¼Œä¸ç»™ç”¨æˆ·é€ æˆä¸­æ–­ï¼›
4.  æ–¹æ¡ˆéœ€å…¼å®¹ç°æœ‰å¾®å‰ç«¯æ¶æ„ä¸ CI/CD æµç¨‹ï¼Œä¸ä¾èµ–åç«¯æ”¹é€ ã€‚

## 2. æ–¹æ¡ˆæ¢ç´¢ä¸å–èˆ

åœ¨åŠ¨æ‰‹å‰ï¼Œæˆ‘ä»¬åˆ—å‡ºå‡ ç§å¯è¡Œæ–¹å¼ï¼š

| æ–¹æ¡ˆ                 | å®ç°å¤æ‚åº¦ | å®æ—¶æ€§    | ä¾èµ–         | é€‚é…åœºæ™¯   | å…³é”®ä¼˜ç¼ºç‚¹       |
| ------------------ | ----- | ------ | ---------- | ------ | ----------- |
| çº¯å‰ç«¯è½®è¯¢ version.json | ä½     | ä¸­ï¼ˆ30sï¼‰ | å‰ç«¯ + Nginx | å¤šç¯å¢ƒå¾®å‰ç«¯ | æˆæœ¬æœ€ä½ï¼›è½»å¾®ç½‘ç»œå¼€é”€ |
| Service Worker/PWA | ä¸­     | è¾ƒé«˜     | ç°ä»£æµè§ˆå™¨      | PWA åº”ç”¨ | ç¼“å­˜æ§åˆ¶å¥½ï¼Œä½†æ”¹é€ é‡å¤§ |
| WebSocket æ¨é€       | é«˜     | æœ€é«˜     | åç«¯æœåŠ¡       | å¼ºå®æ—¶åœºæ™¯  | éœ€è¦é¢å¤–æœåŠ¡ç«¯å¼€å‘   |
| åç«¯æ¥å£ç»Ÿä¸€ç®¡ç†           | ä¸­     | ä¸­      | å‰åç«¯        | ç‰ˆæœ¬é›†ä¸­ç®¡ç† | å¸¦æ¥è·¨å›¢é˜Ÿè€¦åˆ     |

ç»¼åˆå›¢é˜Ÿèµ„æºä¸è½åœ°é€Ÿåº¦ï¼Œæˆ‘ä»¬é€‰æ‹©äº† **çº¯å‰ç«¯è½®è¯¢ + é™æ€ç‰ˆæœ¬æ–‡ä»¶** çš„åšæ³•ï¼Œå¹¶æ˜ç¡®ä¸¤ä¸ªåŸåˆ™ï¼š

*   **ç‰ˆæœ¬å·å”¯ä¸€ï¼Œå¯è¿½æº¯**ï¼š`åŸºç¡€ç‰ˆæœ¬å·-ç¯å¢ƒ-æ—¶é—´æˆ³`ï¼›
*   **å‘å¸ƒé›¶ä¾µå…¥**ï¼šJenkins ä»æ—§è¿è¡Œ `npm run build-xxx`ï¼Œæ— éœ€æ–°å¢æ­¥éª¤ã€‚

## 3. æŠ€æœ¯æ–¹æ¡ˆæ€»è§ˆ

1.  **æ„å»ºé˜¶æ®µç”Ÿæˆ version.json**ï¼šåœ¨ `vue.config.js` ä¸­æå‰è®¡ç®—ç‰ˆæœ¬å·ï¼Œæ—¢æ³¨å…¥åˆ°å‰ç«¯ï¼ˆ`process.env.APP_VERSION`ï¼‰ï¼Œä¹Ÿå†™å…¥è¾“å‡ºç›®å½•çš„ `version.json`ï¼›
2.  **å‰ç«¯è½®è¯¢æ¯”å¯¹**ï¼šåº”ç”¨å¯åŠ¨åæ¯ 30 ç§’è¯·æ±‚ä¸€æ¬¡ `version.json`ï¼Œç¦ç”¨ç¼“å­˜å¹¶æºå¸¦æ—¶é—´æˆ³ï¼Œæ¯”è¾ƒç‰ˆæœ¬å·ï¼›
3.  **äº¤äº’æç¤º**ï¼šå¤ç”¨ Ant Design Vue çš„ `Modal.confirm`ï¼Œå±•ç¤ºå½“å‰/æœ€æ–°ç‰ˆæœ¬ä¸ç¯å¢ƒï¼›
4.  **ç¼“å­˜ç­–ç•¥**ï¼šNginx å¯¹ HTML/`version.json` ç¦æ­¢ç¼“å­˜ï¼Œå¯¹ JS/CSS/å›¾ç‰‡ç»§ç»­é•¿ç¼“å­˜ï¼›
5.  **CI/CD é…åˆ**ï¼šæ¨èåœ¨æ„å»ºå‘½ä»¤ä¸­ä¼ å…¥ç»Ÿä¸€æ—¶é—´æˆ³ï¼Œç¡®ä¿åŒä¸€æ„å»ºä»»åŠ¡çš„æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·ã€‚

## 4. å…³é”®è½åœ°ç»†èŠ‚

### 4.1 è·¨å¹³å°æ„å»ºè„šæœ¬é…ç½®ï¼ˆCross Platform Build Script Configurationï¼‰

ä¸ºäº†ç¡®ä¿ Windows/Linux/macOS ç¯å¢ƒéƒ½èƒ½æ­£ç¡®è®¾ç½®æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬åœ¨ `package.json` ä¸­ä½¿ç”¨ `cross-env` å’Œç‹¬ç«‹çš„æ—¶é—´æˆ³è„šæœ¬ï¼š

```json
{
  "scripts": {
    "build": "cross-env BUILD_TIMESTAMP=$(node scripts/get-timestamp.js) NODE_OPTIONS=--openssl-legacy-provider vue-cli-service build --mode production",
    "build-develop": "cross-env BUILD_TIMESTAMP=$(node scripts/get-timestamp.js) NODE_OPTIONS=--openssl-legacy-provider vue-cli-service build --mode develop",
    "build-testing": "cross-env BUILD_TIMESTAMP=$(node scripts/get-timestamp.js) NODE_OPTIONS=--openssl-legacy-provider vue-cli-service build --mode testing",
    "build-release": "cross-env BUILD_TIMESTAMP=$(node scripts/get-timestamp.js) NODE_OPTIONS=--openssl-legacy-provider vue-cli-service build --mode release"
  }
}
```

```javascript
// scripts/get-timestamp.js
// è·¨å¹³å°è·å–æ—¶é—´æˆ³
const timestamp = new Date().toISOString().slice(0, 16).replace(/[-T:]/g, "");
console.log(timestamp);
```

**å…³é”®ç‚¹**ï¼š

*   `cross-env` ç¡®ä¿ç¯å¢ƒå˜é‡åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸‹æ­£ç¡®ä¼ é€’
*   ç‹¬ç«‹çš„æ—¶é—´æˆ³è„šæœ¬é¿å… shell å‘½ä»¤å…¼å®¹æ€§é—®é¢˜

### 4.2 ç‰ˆæœ¬å·åªç”Ÿæˆä¸€æ¬¡ï¼ˆBuild-time Deterministic Versioningï¼‰

ä¸ºäº†å½»åº•è§£å†³"ç‰ˆæœ¬å·æ‰“æ¶"é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ `vue.config.js` ä¸­é‡‡ç”¨äº†**æ¨¡å—åŠ è½½æ—¶ç¡®å®šæ—¶é—´æˆ³**çš„ç­–ç•¥ï¼š

```javascript
const fs = require("fs");
const path = require("path");
const packageJson = require("./package.json");

// âš ï¸ é‡è¦ï¼šåœ¨æ¨¡å—åŠ è½½æ—¶ç¡®å®šæ„å»ºæ—¶é—´æˆ³ï¼Œé¿å…å¤šè¿›ç¨‹æ„å»ºæ—¶ç‰ˆæœ¬å·ä¸ä¸€è‡´
// Webpack/Vite å¤šè¿›ç¨‹æ„å»ºæ—¶ï¼Œæ¯ä¸ª worker è¿›ç¨‹ç‹¬ç«‹æ‰§è¡Œä»£ç ï¼Œå¦‚æœå¤šæ¬¡è°ƒç”¨ new Date()
// å¯èƒ½åœ¨ä¸åŒè¿›ç¨‹ã€ä¸åŒæ—¶é—´ç‚¹ç”Ÿæˆä¸åŒçš„æ—¶é—´æˆ³ï¼Œå¯¼è‡´åŒä¸€æ„å»ºäº§ç‰©ç‰ˆæœ¬å·ä¸ä¸€è‡´
// æ–¹æ¡ˆï¼šä¼˜å…ˆä½¿ç”¨ CI/CD ä¼ å…¥çš„ BUILD_TIMESTAMPï¼Œå¦åˆ™åœ¨æ¨¡å—åŠ è½½æ—¶ç¡®å®šç»Ÿä¸€æ—¶é—´æˆ³
const BUILD_TIMESTAMP =
  process.env.BUILD_TIMESTAMP ||
  (() => {
    const now = new Date();
    return now.toISOString().slice(0, 16).replace(/[-T:]/g, "");
  })();

// æ ¼å¼åŒ–æ—¶é—´æˆ³ï¼šå¹´æœˆæ—¥æ—¶åˆ†ï¼ˆå¦‚202310301500ï¼‰
function getFormattedTimestamp() {
  // ä½¿ç”¨æ¨¡å—åŠ è½½æ—¶ç¡®å®šçš„ç»Ÿä¸€æ—¶é—´æˆ³
  return BUILD_TIMESTAMP;
}

// è·å–å½“å‰ç¯å¢ƒåç§°
function getEnvName() {
  return process.env.VUE_APP_ENV || "develop";
}

// ç”Ÿæˆå¤åˆç‰ˆæœ¬å·ï¼šåŸºç¡€ç‰ˆæœ¬+ç¯å¢ƒ+æ—¶é—´æˆ³
function getAppVersion() {
  const baseVersion = packageJson.version;
  const envName = getEnvName();
  const timestamp = getFormattedTimestamp();
  return `${baseVersion}-${envName}-${timestamp}`;
}

// âš ï¸ å…³é”®ï¼šæ„å»ºé˜¶æ®µä»…ç”Ÿæˆä¸€æ¬¡ç‰ˆæœ¬å·å’Œç¯å¢ƒæ ‡è¯†ï¼Œä¿æŒå‰ç«¯æ³¨å…¥ä¸ version.json å®Œå…¨ä¸€è‡´
const buildEnvName = getEnvName();
const buildVersion = getAppVersion();

module.exports = {
  configureWebpack: {
    plugins: [
      new webpack.DefinePlugin({
        "process.env.APP_VERSION": JSON.stringify(buildVersion),
        "process.env.APP_ENV": JSON.stringify(buildEnvName),
      }),
    ],
  },
  chainWebpack(config) {
    config.plugin("generate-version-json").use({
      apply(compiler) {
        compiler.hooks.done.tap("GenerateVersionJsonPlugin", () => {
          fs.writeFileSync(
            path.resolve(__dirname, "edu/version.json"),
            JSON.stringify(
              {
                version: buildVersion,
                env: buildEnvName,
                timestamp: new Date().toISOString(),
                publicPath: "/child/edu",
              },
              null,
              2
            )
          );
        });
      },
    });
  },
};
```

**æ ¸å¿ƒæ”¹è¿›ç‚¹**ï¼š

1.  **ä¼˜å…ˆä½¿ç”¨ CI/CD ä¼ å…¥çš„æ—¶é—´æˆ³**ï¼šé€šè¿‡ `BUILD_TIMESTAMP` ç¯å¢ƒå˜é‡ï¼Œè®© Jenkins ç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬å·ï¼›
2.  **æ¨¡å—åŠ è½½æ—¶ç¡®å®šå…œåº•æ—¶é—´æˆ³**ï¼šå¦‚æœæ²¡æœ‰ä¼ å…¥ç¯å¢ƒå˜é‡ï¼Œåœ¨æ¨¡å—åŠ è½½æ—¶ï¼ˆè€Œéå‡½æ•°è°ƒç”¨æ—¶ï¼‰ç¡®å®šæ—¶é—´æˆ³ï¼Œé¿å…å¤šè¿›ç¨‹æ„å»ºæ—¶äº§ç”Ÿä¸åŒç‰ˆæœ¬å·ï¼›
3.  **å…¨å±€å¤ç”¨ç‰ˆæœ¬å·**ï¼š`buildVersion` å’Œ `buildEnvName` åœ¨æ¨¡å—é¡¶å±‚ç¡®å®šåï¼Œè¢« DefinePlugin å’Œ version.json ç”Ÿæˆé€»è¾‘å…±åŒä½¿ç”¨ã€‚

è¿™æ ·å³ä½¿æ„å»ºè¿‡ç¨‹æŒç»­ 5 ï½ 10 åˆ†é’Ÿï¼Œæ³¨å…¥çš„ç‰ˆæœ¬å·å’Œé™æ€æ–‡ä»¶é‡Œçš„ç‰ˆæœ¬ä»ä¿æŒä¸€è‡´ã€‚è¿™å…¶å®æ˜¯æŠŠ"æ„å»ºäº§ç‰©è§†ä¸ºä¸å¯å˜å·¥ä»¶"çš„åŸåˆ™è½åœ°â€”â€”ä¿è¯ä»»ä½•ä½¿ç”¨è¯¥å·¥ä»¶çš„å…¥å£çœ‹åˆ°çš„å…ƒæ•°æ®éƒ½æ˜¯åŒä¸€ä¸ªå¿«ç…§ã€‚

### 4.3 ç‰ˆæœ¬æ£€æŸ¥å™¨ï¼ˆRuntime Polling & Cache Bustingï¼‰

```javascript
class VersionChecker {
  currentVersion = process.env.APP_VERSION;
  publicPath = "/child/edu";
  checkInterval = 30 * 1000;

  init() {
    console.log(
      `ğŸ“Œ å½“å‰å‰ç«¯ç‰ˆæœ¬ï¼š${this.currentVersion}ï¼ˆ${process.env.APP_ENV}ï¼‰`
    );
    this.startChecking();
    document.addEventListener("visibilitychange", () => {
      if (document.visibilityState === "visible" && !this.hasNotified) {
        this.checkForUpdate();
      }
    });
  }

  async checkForUpdate() {
    const url = `${this.publicPath}/version.json?t=${Date.now()}`;
    const response = await fetch(url, { cache: "no-store" });
    if (!response.ok) return;
    const latestInfo = await response.json();
    if (latestInfo.version !== this.currentVersion && !this.hasNotified) {
      this.hasNotified = true;
      this.stopChecking();
      this.showUpdateModal(latestInfo.version, latestInfo.env);
    }
  }
}
```

è¿™é‡Œæœ‰ä¸¤ä¸ªå®¹æ˜“è¢«å¿½ç•¥çš„ç»†èŠ‚ï¼š

1.  `fetch` æ˜¾å¼åŠ  `cache: "no-store"`ï¼Œå†å åŠ æ—¶é—´æˆ³å‚æ•°ï¼Œé˜²æ­¢ CDN / æµè§ˆå™¨ä»»ä½•ä¸€å±‚å¹²é¢„ï¼›
2.  `visibilitychange` ç›‘å¬ï¼Œä¿è¯çª—å£é‡æ–°æ¿€æ´»æ—¶ç«‹å³æ¯”å¯¹ï¼Œé¿å…ç”¨æˆ·åœ¨åå°ç­‰äº†å¾ˆä¹…æ‰çœ‹åˆ°å¼¹çª—ã€‚

å…¥å£ `main.ts` åœ¨åº”ç”¨ mount ä¹‹åè°ƒç”¨ `versionChecker.init()`ï¼Œå³å¯æŠŠæ•´ä¸ªæ£€æµ‹é“¾è·¯ä¸²èµ·æ¥ã€‚

### 4.4 Nginx ç¼“å­˜ç­–ç•¥ï¼ˆPrecise Cache Partitionï¼‰

```nginx
location / {
    if ($request_filename ~* \.html$) {
        add_header Cache-Control "no-store, no-cache, must-revalidate";
    }
}

location /child/edu {
    if ($request_filename ~* \.html$) {
        add_header Cache-Control "no-store, no-cache, must-revalidate";
    }
}

location ~* /child/edu/version\.json$ {
    add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
    add_header Surrogate-Control "no-store";
}
```

è¿™ä¸€å±‚çš„æ€è·¯æ˜¯æŠŠèµ„æºåˆ†æˆä¸¤ç±»ï¼šéœ€è¦å®æ—¶æ€§ï¼ˆHTMLã€version.jsonï¼‰å°± `no-store`ï¼Œå…¶ä½™èµ°é•¿ç¼“å­˜ã€‚å†é…åˆ `try_files` å…œåº• history è·¯ç”±ï¼Œå¾®å‰ç«¯å­åº”ç”¨çš„ç‹¬ç«‹éƒ¨ç½²ä¸ä¼šäº’ç›¸å½±å“ã€‚

### 4.5 CI/CD é…ç½®ï¼ˆZero-touch Pipelineï¼‰

**æ¨èæ–¹æ¡ˆ**ï¼šåœ¨ Jenkins æ„å»ºå‘½ä»¤ä¸­ä¼ å…¥ç»Ÿä¸€çš„æ„å»ºæ—¶é—´æˆ³ï¼Œç¡®ä¿åŒä¸€æ„å»ºä»»åŠ¡çš„æ‰€æœ‰è¿›ç¨‹ä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·ï¼š

| ç¯å¢ƒ         | æ„å»ºå‘½ä»¤ï¼ˆæ¨èï¼‰                                                                      | æ„å»ºå‘½ä»¤ï¼ˆç®€åŒ–ç‰ˆï¼‰                  | è¯´æ˜     |
| ---------- | ----------------------------------------------------------------------------- | -------------------------- | ------ |
| develop    | `BUILD_TIMESTAMP=$(date +%Y%m%d%H%M) npm install && npm run build-develop`    | `npm run build-develop`    | æ—¥å¸¸å¼€å‘éªŒè¯ |
| testing    | `BUILD_TIMESTAMP=$(date +%Y%m%d%H%M) npm install && npm run build-testing`    | `npm run build-testing`    | é›†æˆæµ‹è¯•   |
| release    | `BUILD_TIMESTAMP=$(date +%Y%m%d%H%M) npm install && npm run build-release`    | `npm run build-release`    | é¢„å‘å¸ƒ    |
| production | `BUILD_TIMESTAMP=$(date +%Y%m%d%H%M) npm install && npm run build-production` | `npm run build-production` | çº¿ä¸Š     |

**Windows Jenkins èŠ‚ç‚¹ï¼ˆPowerShellï¼‰**ï¼š

```powershell
$env:BUILD_TIMESTAMP = (Get-Date -Format "yyyyMMddHHmm"); npm install; npm run build-develop
```

**è¯´æ˜**ï¼š

*   **æ¨èæ–¹æ¡ˆ**ï¼šä¼ å…¥ `BUILD_TIMESTAMP` ç¯å¢ƒå˜é‡ï¼Œç”± CI/CD æµæ°´çº¿ç»Ÿä¸€ç®¡ç†æ—¶é—´æˆ³ï¼Œä¿è¯åŒä¸€æ„å»ºä»»åŠ¡ç‰ˆæœ¬å·å®Œå…¨ä¸€è‡´
*   **ç®€åŒ–æ–¹æ¡ˆ**ï¼šä¸ä¼ å…¥æ—¶é—´æˆ³æ—¶ï¼Œä»£ç ä¼šåœ¨æ¨¡å—åŠ è½½æ—¶ç¡®å®šæ—¶é—´æˆ³ï¼Œåœ¨å¤šè¿›ç¨‹åœºæ™¯ä¸‹ä»å¯èƒ½å‡ºç°ç»†å¾®å·®å¼‚ï¼ˆæ¦‚ç‡è¾ƒä½ï¼‰
*   **å¦‚éœ€ç²¾ç¡®æ§åˆ¶ç‰ˆæœ¬å·ï¼Œå»ºè®®é‡‡ç”¨æ¨èæ–¹æ¡ˆ**

æ‰€æœ‰å‘½ä»¤éƒ½å¸¦ `cross-env NODE_OPTIONS=--openssl-legacy-provider`ï¼Œä»¥å…¼å®¹ä¸åŒç³»ç»Ÿçš„ OpenSSL ç‰ˆæœ¬ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™å¥—æ–¹æ¡ˆæ²¡æœ‰"è¦æ±‚è¿ç»´å¤šåšä¸€æ­¥"â€”â€”æ„å»ºäº§ç‰©å¤©ç„¶æºå¸¦ version.jsonï¼Œä»»ä½•ç¯å¢ƒæ‹¿åˆ°åŒ…å³å¯ä¸Šçº¿ã€‚

## 5. æµ‹è¯•ä¸éªŒè¯

æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå®Œæ•´çš„å›å½’æµç¨‹ï¼Œç¡®ä¿æ–¹æ¡ˆä¸ä¼šç»™æµ‹è¯•å’Œä¸Šçº¿å¸¦æ¥é¢å¤–è´Ÿæ‹…ï¼š

1.  **é¦–æ¬¡è®¿é—®**ï¼šæ‰“å¼€ dev ç¯å¢ƒé¡µé¢ï¼Œç¡®è®¤æ§åˆ¶å°æ‰“å°ç‰ˆæœ¬å·ï¼ŒNetwork é‡Œèƒ½çœ‹åˆ° `version.json` ä¸”å“åº”å¤´æ— ç¼“å­˜ï¼›
2.  **è§¦å‘æ–°ç‰ˆæœ¬**ï¼šè°ƒæ•´ä»»æ„æ–‡æ¡ˆï¼Œé‡æ–°å‘å¸ƒï¼Œä¿æŒæ—§é¡µé¢ä¸åˆ·æ–°ï¼›
3.  **è½®è¯¢éªŒè¯**ï¼š30 ç§’å†…å¼¹å‡ºæç¤ºæ¡†ï¼Œå±•ç¤ºå½“å‰/æœ€æ–°ç‰ˆæœ¬å’Œç¯å¢ƒï¼›
4.  **äº¤äº’è·¯å¾„**ï¼š
    *   ç‚¹å‡»"ç«‹å³åˆ·æ–°"ï¼šé¡µé¢å¼ºåˆ¶ reloadï¼Œæ–°ç‰ˆæœ¬ç”Ÿæ•ˆï¼›
    *   ç‚¹å‡»"ç¨ååˆ·æ–°"ï¼šè®°å½•å–æ¶ˆåŠ¨ä½œå¹¶é‡æ–°å¼€å¯è½®è¯¢ï¼›
5.  **è¾¹ç•Œåœºæ™¯**ï¼šåˆ‡ tab / æ¸…ç¼“å­˜ / æ–°è®¾å¤‡è®¿é—® / çŸ­æ—¶é—´è¿ç»­å‘å¸ƒï¼Œå‡èƒ½æ­£ç¡®æ„ŸçŸ¥æœ€æ–°ç‰ˆæœ¬ã€‚

## 6. æ³¨æ„äº‹é¡¹ä¸å¸¸è§é—®é¢˜

| ç°è±¡        | å¯èƒ½åŸå›                      | è§£å†³æ–¹æ¡ˆ                                        |
| --------- | ------------------------ | ------------------------------------------- |
| æ²¡æœ‰å¼¹çª—      | `version.json` 404 æˆ–ç‰ˆæœ¬æœªå˜ | æ£€æŸ¥éƒ¨ç½²è·¯å¾„ã€ç¡®è®¤æ„å»ºæ˜¯å¦ç”Ÿæˆæ–‡ä»¶                           |
| å¼¹çª—ååˆ·æ–°ä»æ—§ç‰ˆæœ¬ | é™æ€èµ„æºè¢«ç¼“å­˜                  | æ ¸å® Nginx ç¼“å­˜ç­–ç•¥ã€æŸ¥çœ‹æµè§ˆå™¨ç¼“å­˜è®¾ç½®                     |
| æ„å»ºå¤±è´¥      | `cross-env` æœªå®‰è£…æˆ–æƒé™ä¸è¶³     | è¡¥å……ä¾èµ–ã€ç¡®ä¿ Jenkins å·¥ä½œç›®å½•å¯å†™                      |
| æŒç»­è¯¯æŠ¥æ›´æ–°    | æ„å»ºé˜¶æ®µå¤šæ¬¡ç”Ÿæˆç‰ˆæœ¬å·              | åœ¨ `vue.config.js` é¡¶éƒ¨ç¼“å­˜ `buildVersion` å¹¶å…¨å±€å¤ç”¨ |

## 7. è½åœ°æˆæ•ˆ

*   æ—§é¡µé¢ç”¨æˆ·åœ¨ 30 ç§’å†…æ”¶åˆ°æé†’ï¼Œæµ‹è¯•æ•ˆç‡æ˜¾è‘—æå‡ï¼›
*   "å¹½çµå¼¹çª—"å½»åº•æ¶ˆå¤±ï¼Œç‰ˆæœ¬å¯¹æ¯”é€»è¾‘ç¨³å®šï¼›
*   æ–¹æ¡ˆåªè§¦ç¢°å‰ç«¯ä¸ Nginx é…ç½®ï¼Œå‘å¸ƒæµç¨‹æ— éœ€æ”¹é€ ï¼›
*   æ–‡æ¡£åŒ–åï¼Œå…¶ä»–å­åº”ç”¨æ— éœ€é‡å¤æ€è€ƒï¼Œç›´æ¥å¤ç”¨ã€‚

## 8. å±•æœ›

ä¸‹ä¸€æ­¥æˆ‘ä»¬è®¡åˆ’ï¼š

1.  **å°è£…é€šç”¨ SDK**ï¼šæŠ½è±¡ç‰ˆæœ¬ç”Ÿæˆã€è½®è¯¢ã€å¼¹çª—é€»è¾‘ï¼Œæ”¯æŒ Vue CLI / Viteï¼›
2.  **å¯è§†åŒ–ç‰ˆæœ¬é¢æ¿**ï¼šåœ¨ä¸»åº”ç”¨æ±‡æ€»æ‰€æœ‰ç¯å¢ƒçš„ç‰ˆæœ¬å’Œå‘å¸ƒæ—¶é—´ï¼›
3.  **å·®å¼‚åŒ–ç­–ç•¥**ï¼šé’ˆå¯¹é«˜ä¼˜å…ˆçº§ç‰ˆæœ¬å¼ºåˆ¶åˆ·æ–°ï¼Œæ™®é€šç‰ˆæœ¬å…è®¸ç”¨æˆ·è‡ªè¡Œé€‰æ‹©ã€‚

***

è¿™æ¬¡å®è·µè®©æˆ‘å†æ¬¡æ„è¯†åˆ°ï¼šçœŸæ­£çš„å‘å¾€å¾€è—åœ¨çœ‹ä¼¼"å¾®ä¸è¶³é“"çš„ç»†èŠ‚é‡Œã€‚å½“æˆ‘ä»¬æŠŠé—®é¢˜å’Œæ€è€ƒå†™æˆæ–‡æ¡£ã€æ²‰æ·€æˆæ¨¡æ¿ï¼Œå›¢é˜Ÿå°±èƒ½ä»¥æ›´å°çš„ä»£ä»·è·å¾—æ›´ç¨³å®šçš„äº¤ä»˜ã€‚å¦‚æœä½ ä¹Ÿåœ¨æ¨è¿›å¾®å‰ç«¯ç‰ˆæœ¬åŒæ­¥ï¼Œæ¬¢è¿äº¤æµã€äº’ç›¸å€Ÿé‰´ã€‚
